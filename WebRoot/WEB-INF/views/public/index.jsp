<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
    
    
    <jsp:include flush="true" page="../includes/public/header.jsp">
    	<jsp:param name="title" value="小米商城  - 首页" />
    	<jsp:param name="css_name" value="index1" />
    </jsp:include>
	
	<!-- 带大背景 -->
	<div class="box2">
		<div class="touming"></div>
		<div class="left1">
			<ul>
				<li class="l"><a href="">手机&nbsp;电话卡</a><span>></span></li>
				<li class="l"><a href="">笔记本</a><span>></span></li>
				<li class="l"><a href="">电视&nbsp;盒子</a><span>></span></li>
				<li class="l"><a href="">路由器&nbsp;智能硬件</a><span>></span></li>
				<li class="l"><a href="">移动电源&nbsp;电池&nbsp;插线板</a><span>></span></li>
				<li class="l"><a href="">耳机&nbsp;音响</a><span>></span></li>
				<li class="l"><a href="">保护套&nbsp;贴膜</a><span>></span></li>
				<li class="l"><a href="">线材&nbsp;支架&nbsp;存储卡</a><span>></span></li>
				<li class="l"><a href="">箱包&nbsp;服饰&nbsp;鞋&nbsp;眼镜</a><span>></span></li>
				<li class="l"><a href="">米兔&nbsp;生活周边</a><span>></span></li>
			</ul>
		</div>
		<div class="right1">
			<ul>
				<li><img src="/assets/public/images/zhuye/ban01.jpg" alt=""></li>
				<li><img src="/assets/public/images/zhuye/ban02.jpg" alt=""></li>
				<li><img src="/assets/public/images/zhuye/ban03.jpg" alt=""></li>
				<li><img src="/assets/public/images/zhuye/ban04.jpg" alt=""></li>
				<li><img src="/assets/public/images/zhuye/ban05.jpg" alt=""></li>
				<li><img src="/assets/public/images/zhuye/ban06.jpg" alt=""></li>
				<li><img src="/assets/public/images/zhuye/ban07.jpg" alt=""></li>
			</ul>
			<a href="javascript:;" class="zuo"></a>
			<a href="javascript:;" class="you"></a>
			<div class="dian clea1">
				<span class="change"></span>
				<span></span>
				<span></span>
				<span></span>
				<span></span>
				<span></span>
				<span></span>
			</div>
		</div>
	</div>
	<!-- 小米明星单品 -->
	<div class="mxbiaoti clear">
		<div class="mingxingtiao clear">
			<h2 class="title">小米明星单品</h2>
			<div class="mingxingyou">
				<span class="l-1"></span>
				<span class="r-1"></span>
			</div>
		</div>
		<div class="gundong clear" id="div-slide">
			
		</div>
	</div>
	<!--商品列表-->
	<div class="shangpinbg clear">
		<div id="div-categorylist">
		</div>
	</div>
		
	<!--内容-->
		<div class="stitle"><h2>内容</h2></div>
		<div class="neirongbg">
			<ul class="neirongul clear">
				<li class="neirongli nrli1 left">
					<h2>图书</h2>
					<a href="" class="nrname">哈利·波特与被诅咒的孩子</a>
					<p class="nrjianjie"><a href="">“哈利·波特”第八个故事中文版震撼来袭！特别彩排版剧本！</a></p>
					<p class="nrprice"><a href="">29.37元</a></p>
					<img src="/assets/public/images/neirong/1.png" alt="">
					<ul class="dibuanniu">
						<li class="anniu"><span class="anyuan firstanniu"></span></li>
						<li class="anniu"><span class="anyuan"></span></li>
						<li class="anniu"><span class="anyuan"></span></li>
					</ul>
					<div class="yincanganniu">
						<b class="leftniu"><</b>
						<b class="rightniu">></b>
					</div>
				</li>
				<li class="neirongli nrli2 left">
					<h2>MIUI 主题</h2>
					<a href="" class="nrname">米奇-有你有我</a>
					<p class="nrjianjie"><a href="">米奇来啦！小米主题和迪士尼首度合作，打造精品迪士尼系列主题</a></p>
					<p class="nrprice"><a href="">12米币</a></p>
					<img src="/assets/public/images/neirong/2.png" alt="">
					<ul class="dibuanniu">
						<li class="anniu"><span class="anyuan firstanniu"></span></li>
						<li class="anniu"><span class="anyuan"></span></li>
						<li class="anniu"><span class="anyuan"></span></li>
					</ul>
					<div class="yincanganniu">
						<b class="leftniu"><</b>
						<b class="rightniu">></b>
					</div>
				</li>
				<li class="neirongli nrli3 left">
					<h2>游戏</h2>
					<a href="" class="nrname">小米枪战</a>
					<p class="nrjianjie"><a href="">组好队 去跳伞！！</a></p>
					<p class="nrprice"><a href="">免费</a></p>
					<img src="/assets/public/images/neirong/3.png" alt="">
					<ul class="dibuanniu">
						<li class="anniu"><span class="anyuan firstanniu"></span></li>
						<li class="anniu"><span class="anyuan"></span></li>
						<li class="anniu"><span class="anyuan"></span></li>
					</ul>
					<div class="yincanganniu">
						<b class="leftniu"><</b>
						<b class="rightniu">></b>
					</div>
				</li>
				<li class="neirongli nrli4 left">
					<h2>应用</h2>
					<a href="" class="nrname">2017金米奖</a>
					<p class="nrjianjie"><a href="">最优秀的应用和游戏</a></p>
					<p class="nrprice"><a href=""></a></p>
					<img src="/assets/public/images/neirong/4.png" alt="">
					<ul class="dibuanniu">
						<li class="anniu"><span class="anyuan firstanniu"></span></li>
						<li class="anniu"><span class="anyuan"></span></li>
						<li class="anniu"><span class="anyuan"></span></li>
					</ul>
					<div class="yincanganniu">
						<b class="leftniu"><</b>
						<b class="rightniu">></b>
					</div>
				</li>
			</ul>
		</div>
	<!--视频-->
		<div class="stitle"><h2>视频</h2></div>
		<div class="shipinbg">
			<ul class="spul">
				<li class="firstspli left spli">
					<div class="spimg">
						<video src="/assets/public/snowPerson.mp4"  poster="/assets/public/images/shipin/1.jpg" id="video1"></video>
						<!--<img src="/assets/public/images/shipin/1.jpg" alt="">-->
						<div class="play"><i class="sj" id="sj1"></i></div>
					</div>
					<h3><a href="">品质之魂 存于匠心</a></h3>
					<p><span>红米手机品质的工程师访谈</span></p>
				</li>
				<li class="left spli">
					<div class="spimg">
						<img src="/assets/public/images/shipin/2.jpg" alt="">
						<div class="play"><i class="sj"></i></div>
					</div>
					<h3><a href="">红米手机工艺视频</a></h3>
					<p><span>红米5 / 红米5 Plus 高颜值机身</span></p>
				</li>
				<li class="left spli">
					<div class="spimg">
						<img src="/assets/public/images/shipin/3.jpg" alt="">
						<div class="play"><i class="sj"></i></div>
					</div>
					<h3><a href="">雷军与斯塔克打造全面屏2.0</a></h3>
					<p><span>一场关于小米MIX 2 极致工艺的巅峰对话</span></p>
				</li>
				<li class="left spli">
					<div class="spimg">
						<img src="/assets/public/images/shipin/4.jpg" alt="">
						<div class="play"><i class="sj"></i></div>
					</div>
					<h3><a href="">MIUI 9 理念视频</a></h3>
					<p><span>快如闪电，前所未有的流畅</span></p>
				</li>
			</ul>
		</div>
	</div>
	
	<jsp:include flush="true" page="../includes/public/footer.jsp" />
	
<script>
		var kuang = document.getElementsByClassName("kuang")[0];
		var niu = document.getElementsByClassName("niu")[0];
		var kuanga = document.getElementsByClassName("kuanga");
		var textxiala= document.getElementsByClassName("textxiala")[0];

		var flag=true;
		kuang.onclick = function () {
			if(flag){
				kuang.style.border="1px solid #FF6C0A";
				niu.style.border="1px solid #FF6C0A";
				textxiala.children[0].style.display="block"
//			console.log(textxiala.children[0]);
				console.log(textxiala.children[0].style.display)
				for(var i=0;i<kuanga.length;i++){
					kuanga[i].style.display="none";
				}
				flag=false;
			}else{
				kuang.style.border="1px solid #FF6C0A";
				niu.style.border="1px solid #FF6C0A";
				textxiala.children[0].style.display="none"
//			console.log(textxiala.children[0]);
				console.log(textxiala.children[0].style.display)
				for(var i=0;i<kuanga.length;i++){
					kuanga[i].style.display="block";
				}
				flag=true;
			}

		}

		var sj1 = document.getElementById("sj1");
		var video1 = document.getElementById("sj1");

		sj1.onclick = function () {
			video1.setAttribute("control, ");
		}
</script>
<script>
	total_hot_count = 0;
	function add_to_hot_slide(item) {
		var ul_count = parseInt(total_hot_count / 5);
		if(total_hot_count % 5 == 0) {
			$("#div-slide").append('<ul id="ul-hot-' + ul_count + '"></ul>');
		}
		
		$('#ul-hot-' + ul_count).append('<li class="item' + (total_hot_count % 5 + 1) + '"> \
					<a href="/item/detail?item_id=' + item.id + '" class="aimg"><img src="'+ item.itemImgUri + '" alt=""></a> \
					<a href="/item/detail?item_id=' + item.id + '" class="title1"><b>' + item.itemName + '</b></a> \
					<div class="price1"> \
						<span>' + item.itemPrice + ' 元</span> \
					</div> \
				</li>');
		total_hot_count += 1;
	}
	function category_header(category) {
		return '<div class="shangpintiao clear" id="div-category-header-' + category.id + '"> \
					<span>' + category.categoryName + '</span> \
				</div>';
	}
	function category_model(category, group_index) {
		return '<div class="wutiao clear"> \
					<div class="tiao" id="div-itemlist-' + category.id + '-' + group_index + '-tiao-0" style="display:none;">  \
					</div> \
					<div class="tiao" id="div-itemlist-' + category.id + '-' + group_index + '-tiao-1" style="display:none;">  \
					</div> \
					<div class="tiao" id="div-itemlist-' + category.id + '-' + group_index + '-tiao-2" style="display:none;">  \
					</div> \
					<div class="tiao" id="div-itemlist-' + category.id + '-' + group_index + '-tiao-3"  style="display:none;">  \
					</div> \
					<div class="tiao" id="div-itemlist-' + category.id + '-' + group_index + '-tiao-4"  style="display:none;">  \
					</div> \
				</div><br>';
	}
	function category_link(category) {
		return '<a href="#div-category-header-' + category.id + '">'+ category.categoryName + '</a>';
	}
	
	function item_model(item) {
		return '<div class="items"> \
					<a href="/item/detail?item_id=' + item.id + '"> \
						<img src="' + item.itemImgUri + '" alt=""> \
					</a> \
					<div class="a"> \
						<a href="/item/detail?item_id=' + item.id + '"> \
							<span>' + item.itemName + '</span> \
						</a> \
					</div> \
					<div class="price"> \
						<span>' + item.itemPrice +'元</span> \
					</div> \
				</div>';
	}
	
	function get_item_by_category(category) {
		$.ajax({
	            type: "post",
	            url: "/item/ajax/category/list",
	            async: false, 
	            data: JSON.stringify({
	            	"category_id": category.id
	            }),
	            contentType: "application/json; charset=utf-8",
	            dataType: "json",
	            success: function(data) {
	            	//头部构造
	            	$('#div-categorylist').append(category_header(category));
	            	$('#div-category-link').append(category_link(category));
	            	//先获取数量
	            	for(var i = 0; i <= parseInt(data.length / 10); i++) {
	            		$('#div-categorylist').append(category_model(category, i));
	            	}
	            	
	            	//遍历分类数组
	            	for(var item_index in data) {
	            		var item = data[item_index];
	            		group_index = parseInt(item_index / 10);
	            		tiao_index = item_index % 5;
	            		$('#div-itemlist-' + category.id + '-' + group_index + '-tiao-' + tiao_index).append(item_model(item));
	            		$('#div-itemlist-' + category.id + '-' + group_index + '-tiao-' + tiao_index).show();
	            		
	            		if(item.isHot == 1) {
	            			add_to_hot_slide(item);
	            		}
	            	}
	            } 
	        });
	}
	//初始化，获取类
	$(function() {
		$.ajax({
	            type: "post",
	            url: "/item/category/ajax/list",
	            async: false, 
	            data: JSON.stringify({
	            }),
	            contentType: "application/json; charset=utf-8",
	            dataType: "json",
	            success: function(data) {
	            	//遍历分类数组
	            	for(var category_index in data) {
	            		var category = data[category_index];
	            		get_item_by_category(category);
	            	}
	            	
	            } 
	        });
	});
</script>